%YAML 1.2
---
map:
  00: [ADD, Eb, Gb]
  01: [ADD, Ev, Gv]
  02: [ADD, Gb, Eb]
  03: [ADD, Gv, Ev]
  04: [ADD, AL, Ib]
  05: [ADD, rAX, Iz]
  # [0F] is two byte escape
  10: [ADC, Eb, Gb]
  11: [ADC, Ev, Gv]
  12: [ADC, Gb, Eb]
  13: [ADC, Gv, Ev]
  14: [ADC, AL, Ib]
  15: [ADC, rAX, Iz]
  20: [AND, Eb, Gb]
  21: [AND, Ev, Gv]
  22: [AND, Gb, Eb]
  23: [AND, Gv, Ev]
  24: [AND, AL, Ib]
  25: [AND, rAX, Iz]
  27: [DAA]
  2F: [DAS]
  37: [AAA]
  38: [CMP, Eb, Gb]
  39: [CMP, Ev, Gv]
  3A: [CMP, Gb, Eb]
  3B: [CMP, Gv, Ev]
  3C: [CMP, AL, Ib]
  3D: [CMP, rAX, Iz]
  3F: [AAS]
  # [40-47] are in spans
  # [48-4F] are in spans
  62: [BOUND, Gv, Ma]
  63: [ARPL, Ew, Gw]
  69: [IMUL, Gv, Ev, Iv]
  6B: [IMUL, Gv, Ev, Ib]
  6C: [INS, Yb, DX] # Aliased as INSB
  6D: [INS, Yv, DX] # Aliased as INSW/D
  # [70-7F] are in spans
  # [80-84] is in extensions
  8D: [LEA, Gv, M]
  # TODO: [98] is CBW/CWDE/CDQE
  # TODO: [99] is CWD/CDQ/CQO
  9A: [CALLF, Ap]
  9F: [LAHF]
  A6: [CMPS, Xb, Yb] # or CMPSB
  A7: [CMPS, Xv, Yv] # or CMPS[WDQ]
  AC: [LODS, Xb] # Aliased as LODSB
  AD: [LODS, Xv] # Aliased as LODSW/D/Q
  C4: [LES, Sv, Mp]
  C5: [LDS, Sv, Mp]
  C8: [ENTER, Iw, Ib]
  C9: [LEAVE]
  CC: [INT, "3"]
  CD: [INT, Ib]
  CE: [INTO]
  CF: [IRET]
  D4: [AAM, Ib]
  D5: [AAD, Ib]
  E0: [LOOPNE, Jb]
  E1: [LOOPE, Jb]
  E2: [LOOP, Jb]
  E4: [IN, AL, Ib]
  E5: [IN, eAX, Ib]
  E8: [CALL, Jv]
  E9: [JMP, Jv]
  EA: [JMPF, Ap]
  EB: [JMP, Jb]
  EC: [IN, AL, DX]
  ED: [IN, eAX, DX]
  F0: [LOCK]
  F1: [INT, "1"]
  F4: [HLT]
  F5: [CMC]
  # [F6-F7] is in extensions
  F8: [CLC]
  FA: [CLI]
  FC: [CLD]
  # [FE-FF] is in extensions
spans:
  40:
    length: 8
    instr: [INC, Zz]
  48:
    length: 8
    instr: [DEC, Zz]
  70:
    length: 16
    instr: [Jcc, Jb]
extensions:
  80:
    form: /r
    /0: [ADD, Eb, Ib]
    /2: [ADC, Eb, Ib]
    /4: [AND, Eb, Ib]
    /7: [CMP, Eb, Ib]
  81:
    form: /r
    /0: [ADD, Ev, Iv]
    /2: [ADC, Ev, Iv]
    /4: [AND, Ev, Iv]
    /7: [CMP, Ev, Iv]
  82:
    form: /r
    /0: [ADD, Eb, Ib]
    /2: [ADC, Eb, Ib]
    /4: [AND, Eb, Ib]
    /7: [CMP, Eb, Ib]
  83:
    form: /r
    /0: [ADD, Ev, Ib]
    /2: [ADC, Ev, Ib]
    /4: [AND, Ev, Ib]
    /7: [CMP, Ev, Ib]
  F6:
    form: /r
    /5: [IMUL, Eb]
    /6: [DIV, Eb]
    /7: [IDIV, Eb]
  F7:
    form: /r
    /5: [IMUL, Ev]
    /6: [DIV, Ev]
    /7: [IDIV, Ev]
  FE:
    form: /r
    /0: [INC, Eb]
    /1: [DEC, Eb]
  FF:
    form: /r
    /0: [INC, Ev]
    /1: [DEC, Ev]
    /2: [CALL, Ev]
    /3: [CALLF, Mp]
    /4: [JMP, Ev]
    /5: [JMPF, Ap]
