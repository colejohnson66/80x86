%YAML 1.2
---
map:
  # [00] is in extensions
  # [01] is in extensions
  02: [LAR, Gw, Ew]
  03: [LSL, Gw, Ew]
  06: [CLTS]
  08: [INVD]
  1A:
    NP: [BNDLDX, BGdq, M]
    66: [BNDMOV, BGdq, BEy]
    F3: [BNDCL, BGdq, Ey]
    F2: [BNDCU, BGdq, Ey]
  1B:
    NP: [BNDSTX, M, BGdq]
    66: [BNDMOV, BEy, BGdq]
    F3: [BNDMK, BGdq, My]
    F2: [BNDCN, BGdq, Ey]
  # [1C] is in extensions
  # [1E] is in extensions
  2A:
    NP: [CVTPI2PS, Vpv, Qpi]
    66: [CVTPI2PD, Vpv, Qpi]
    F3: [CVTSI2SS, Vsv, Ey]
    F2: [CVTSI2SD, Vsv, Ey]
  2C:
    NP: [CVTTPS2PI, Ppi, Wpv]
    66: [CVTTPD2PI, Ppi, Wpv]
    F3: [CVTTSS2SI, Gy, Wsv]
    F2: [CVTTSD2SI, Gy, Wsv]
  2D:
    NP: [CVTPS2PI, Ppi, Wpv]
    66: [CVTPD2PI, Ppi, Wpv]
    F3: [CVTSS2SI, Gy, Wsv]
    F2: [CVTSD2SI, Gy, Wsv]
  2F:
    NP: [COMISS, Vpv, Wpv]
    66: [COMISD, Vpv, Wpv]
  # [40-4F] are in spans
  54:
    NP: [ANDPS, Vpv, Wpv]
    66: [ANDPD, Vpv, Wpv]
  55:
    NP: [ANDNPS, Vpv, Wpv]
    66: [ANDNPD, Vpv, Wpv]
  58:
    NP: [ADDPS, Vpv, Wpv]
    66: [ADDPD, Vpv, Wpv]
    F3: [ADDSS, Vsv, Wsv]
    F2: [ADDSD, Vsv, Wsv]
  5A:
    NP: [CVTPS2PD, Vpv, Wpv]
    66: [CVTPD2PS, Vpv, Wpv]
    F3: [CVTSS2SD, Vpv, Wsv]
    F2: [CVTSD2SS, Vpv, Wsv]
  5B:
    NP: [CVTDQ2PS, Vpv, Wpv]
    66: [CVTPS2DQ, Vpv, Wpv]
    F3: [CVTTPS2DQ, Vpv, Wpv]
    F2:
  5E:
    NP: [DIVPS, Vpv, Wpv]
    66: [DIVPD, Vpv, Wpv]
    F3: [DIVSS, Vsv, Wsv]
    F2: [DIVSD, Vsv, Wsv]
  77:
    NP: [EMMS]
  7C:
    66: [HADDPD, Vpv, Wpv]
    F2: [HADDPS, Vpv, Wpv]
  7D:
    66: [HSUBPD, Vpv, Wpv]
    F2: [HSUBPS, Vpv, Wpv]
  # [80-8F] are in spans
  A2: [CPUID]
  A3: [BT, Ev, Gv]
  AB: [BTS, Ev, Gv]
  # [AE] is in extensions
  AF: [IMUL, Gv, Ev]
  B0: [CMPXCHG, Eb, Gb]
  B1: [CMPXCHG, Ev, Gv]
  B2: [LSS, Sv, Mp]
  B3: [BTR, Ev, Gv]
  B4: [LFS, Sv, Mp]
  B5: [LGS, Sv, Mp]
  # [BA] is in extensions
  BB: [BTC, Ev, Gv]
  BC: [BSF, Gv, Ev]
  BD:
    N/A: [BSR, Gv, Ey] # TODO: BSR is not the same as LZCNT, but LZCNT will execute
    F3: [LZCNT, Gv, Ey] # as BSR if LZCNT isn't supported
  C2:
    NP: [CMPPS, Vpv, Wpv, Ib]
    66: [CMPPD, Vpv, Wpv, Ib]
    F3: [CMPSS, Vsv, Wsv, Ib]
    F2: [CMPSD, Vsv, Wsv, Ib]
  # [C7] is in extensions
  # [C8-CF] are in spans
  D0:
    66: [ADDSUBPD, Vpv, Wpv]
    F2: [ADDSUBPS, Vpv, Wpv]
  E6:
    66: [CVTTPD2DQ, Vpv, Wpv]
    F3: [CVTDQ2PD, Vpv, Wpv]
    F2: [CVTPD2DQ, Vpv, Wpv]
  F0:
    F2: [LDDQU, Vpv, M]
spans:
  40:
    length: 16
    instr: [CMOVcc, Gv, Ev]
  80:
    length: 16
    instr: [Jcc, Jv]
  C8:
    length: 8
    instr: [BSWAP, Zy]
extensions:
  00:
    form: /r
    /2: [LLDT, Ew]
    /3: [LTR, Ew]
  01:
    form: m/r/b
    M/2/b: [LGDT, Ms]
    M/3/b: [LIDT, Ms]
    M/6/b: [LMSW, Ew] # See also `R/6/b`
    M/7/b: [INVLPG, M]
    R/1/2: [CLAC]
    R/6/b: [LMSW, Ew] # See also `M/6/b`
  1C:
    form: pfx-m/r
    NP-M/0: [CLDEMOTE, Mb]
  1E:
    form: pfx-m/r/b
    F3-r/7/2: [ENDBR64]
    F3-r/7/3: [ENDBR32]
  AE:
    form: pfx-m/r/b
    NP-M/0/b: [FXSAVE, Mdqq]
    NP-M/1/b: [FXRSTOR, Mdqq]
    NP-M/2/b: [LDMXCSR, Md]
    NP-M/7/b: [CLFLUSH, Mb]
    NP-R/5/0: [LFENCE]
    66-M/6/b: [CLWB, Mb]
    66-M/7/b: [CLFLUSHOPT, Mb] # TODO: Prefix is listed as [NFx 66 ...]
    F3-M/6/b: [CLRSSBSY, Mq]
    F3-R/5/b: [INCSSPD, Ry] # TODO: INCSSPQ for 64 bit operands
  BA:
    form: /r
    /4: [BT, Ev, Ib]
    /5: [BTS, Ev, Ib]
    /6: [BTR, Ev, Ib]
    /7: [BTC, Ev, Ib]
  C7:
    form: m/r
    M/1: [CMPXCHG8B, Mq] # TODO: CMPXCHG16B_Mdq with REX prefix

notes:
  - LAR has a 32 bit form listed, but always operates in 16 bit form
  - >-
    LSL has 32 and 64 bit forms listed, but always operates in 16 bit form
    A REX.W prefix will turn this into "64" bit form, but the only difference will be zeroing the upper 32 bits in the destination
